CREATE TABLE owners (
    owner_id NUMBER(10) PRIMARY KEY,
    first_name VARCHAR2(50) NOT NULL,
    last_name VARCHAR2(50) NOT NULL,
    email VARCHAR2(100) UNIQUE,
    phone_number VARCHAR2(15),
    address VARCHAR2(255),
    registration_date DATE DEFAULT SYSDATE
);

-- 2. Create the Pets table
CREATE TABLE pets (
    pet_id NUMBER(10) PRIMARY KEY,
    pet_name VARCHAR2(50) NOT NULL,
    species VARCHAR2(50),
    breed VARCHAR2(50),
    age NUMBER(3),
    owner_id NUMBER(10),
    admission_date DATE DEFAULT SYSDATE,
    FOREIGN KEY (owner_id) REFERENCES owners(owner_id)
);

-- 3. Create the Veterinarians table
CREATE TABLE veterinarians (
    vet_id NUMBER(10) PRIMARY KEY,
    first_name VARCHAR2(50) NOT NULL,
    last_name VARCHAR2(50) NOT NULL,
    specialization VARCHAR2(100),
    phone_number VARCHAR2(15)
);

-- 4. Create the Pet Care Activities table
CREATE TABLE pet_care (
    care_id NUMBER(10) PRIMARY KEY,
    pet_id NUMBER(10),
    care_type VARCHAR2(50),  -- e.g., "Feeding", "Grooming", "Checkup"
    care_date DATE DEFAULT SYSDATE,
    care_notes VARCHAR2(255),
    FOREIGN KEY (pet_id) REFERENCES pets(pet_id)
);

-- 5. Create the Appointments table
CREATE TABLE appointments (
    appointment_id NUMBER(10) PRIMARY KEY,
    pet_id NUMBER(10),
    vet_id NUMBER(10),
    appointment_date DATE,
    reason VARCHAR2(255),
    status VARCHAR2(20) DEFAULT 'Scheduled',  -- Scheduled, Completed, Cancelled
    FOREIGN KEY (pet_id) REFERENCES pets(pet_id),
    FOREIGN KEY (vet_id) REFERENCES veterinarians(vet_id)
);





-- Insert owners
INSERT INTO owners (owner_id, first_name, last_name, email, phone_number, address) 
VALUES (1, 'John', 'Doe', 'john.doe@example.com', '1234567890', '123 Elm St');
INSERT INTO owners (owner_id, first_name, last_name, email, phone_number, address) 
VALUES (2, 'Jane', 'Smith', 'jane.smith@example.com', '0987654321', '456 Oak St');

-- Insert pets
INSERT INTO pets (pet_id, pet_name, species, breed, age, owner_id) 
VALUES (1, 'Buddy', 'Dog', 'Golden Retriever', 3, 1);
INSERT INTO pets (pet_id, pet_name, species, breed, age, owner_id) 
VALUES (2, 'Mittens', 'Cat', 'Persian', 2, 2);

-- Insert veterinarians
INSERT INTO veterinarians (vet_id, first_name, last_name, specialization, phone_number) 
VALUES (1, 'Dr. Alice', 'Johnson', 'General Practitioner', '1112233445');
INSERT INTO veterinarians (vet_id, first_name, last_name, specialization, phone_number) 
VALUES (2, 'Dr. Bob', 'Miller', 'Dermatology', '2233445566');

-- Insert pet care activities
INSERT INTO pet_care (care_id, pet_id, care_type, care_notes) 
VALUES (1, 1, 'Feeding', 'Buddy had his morning meal of dry food.');
INSERT INTO pet_care (care_id, pet_id, care_type, care_notes) 
VALUES (2, 2, 'Grooming', 'Mittens was groomed today, fur trimmed and nails clipped.');

-- Insert appointments
INSERT INTO appointments (appointment_id, pet_id, vet_id, appointment_date, reason) 
VALUES (1, 1, 1, TO_DATE('2025-01-10', 'YYYY-MM-DD'), 'Routine checkup');
INSERT INTO appointments (appointment_id, pet_id, vet_id, appointment_date, reason) 
VALUES (2, 2, 2, TO_DATE('2025-01-12', 'YYYY-MM-DD'), 'Skin irritation checkup');
CREATE SEQUENCE pets_seq START WITH 1 INCREMENT BY 1;
CREATE SEQUENCE appointments_seq START WITH 1 INCREMENT BY 1;
CREATE SEQUENCE pet_care_seq START WITH 1 INCREMENT BY 1;



SELECT * FROM user_sequences WHERE sequence_name = 'PETS_SEQ';


CREATE OR REPLACE PROCEDURE add_new_pet (
    p_pet_name IN VARCHAR2,
    p_species IN VARCHAR2,
    p_breed IN VARCHAR2,
    p_age IN NUMBER,
    p_owner_id IN NUMBER
) AS
BEGIN
    -- Inserting the new pet with the pet_id generated by the sequence
    INSERT INTO pets (pet_id, pet_name, species, breed, age, owner_id)
    VALUES (pets_seq.NEXTVAL, p_pet_name, p_species, p_breed, p_age, p_owner_id);
    
    -- Committing the changes to make them permanent
    COMMIT;
END add_new_pet;
/





CREATE OR REPLACE PROCEDURE schedule_appointment (
    p_pet_id IN NUMBER,
    p_vet_id IN NUMBER,
    p_appointment_date IN DATE,
    p_reason IN VARCHAR2
) AS
BEGIN
    INSERT INTO appointments (appointment_id, pet_id, vet_id, appointment_date, reason)
    VALUES (appointments_seq.NEXTVAL, p_pet_id, p_vet_id, p_appointment_date, p_reason);
    COMMIT;
END schedule_appointment;
/




CREATE OR REPLACE PROCEDURE record_pet_care (
    p_pet_id IN NUMBER,
    p_care_type IN VARCHAR2,
    p_care_notes IN VARCHAR2
) AS
BEGIN
    INSERT INTO pet_care (care_id, pet_id, care_type, care_notes)
    VALUES (pet_care_seq.NEXTVAL, p_pet_id, p_care_type, p_care_notes);
    COMMIT;
END record_pet_care;
/




CREATE OR REPLACE VIEW pets_and_owners AS
SELECT p.pet_id, p.pet_name, p.species, p.breed, p.age, o.first_name AS owner_first_name, o.last_name AS owner_last_name
FROM pets p
JOIN owners o ON p.owner_id = o.owner_id;





CREATE OR REPLACE VIEW pet_appointments AS
SELECT a.appointment_id, p.pet_name, v.first_name AS vet_first_name, v.last_name AS vet_last_name, 
       a.appointment_date, a.reason, a.status
FROM appointments a
JOIN pets p ON a.pet_id = p.pet_id
JOIN veterinarians v ON a.vet_id = v.vet_id;




SELECT * FROM pets_and_owners;
SELECT * FROM pet_appointments WHERE status = 'Scheduled';
SELECT * FROM pet_care WHERE pet_id = 1;
